<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A R package extending {Microsoft365R} to make it easier to
    read, write, and work with SharePoint items, lists, and plans.">
<title>Read and Write from SharePoint Sites • sharepointr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Read and Write from SharePoint Sites">
<meta property="og:description" content="A R package extending {Microsoft365R} to make it easier to
    read, write, and work with SharePoint items, lists, and plans.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">sharepointr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/sp_url.html">Using SharePoint URLs to work with items and lists</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/elipousson/sharepointr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sharepointr">sharepointr<a class="anchor" aria-label="anchor" href="#sharepointr"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
<p>The goal of SharePointR is to make it easier to read, write, and work with files stored in SharePoint by extending the <a href="https://github.com/Azure/Microsoft365R" class="external-link">Microsoft365R</a> package.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of SharePointR like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pak::pkg_install("elipousson/sharepointr")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<p>To use this package (or <code>{Microsoft365}</code>) you must:</p>
<ul>
<li>Have a work or school account with access to <a href="https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration" class="external-link">Microsoft SharePoint</a>
</li>
<li>Have enabled permissions for the default <code>{Microsoft365}</code> app ID</li>
</ul>
<p>See the <code>{Microsoft365}</code> <a href="https://github.com/Azure/Microsoft365R/blob/master/inst/app_registration.md" class="external-link">documentation on app registration for more information</a>.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p><code>{Microsoft365}</code> uses S6 methods for nearly everything which may be difficult for users (me included) who are less familiar with this interface.</p>
<p>The <a href="https://github.com/elipousson/sharepointr" class="external-link">sharepointr</a> package seeks to ease this challenge by wrapping the <code>{Microsoft365}</code> methods and adding support for the specification of SharePoint sites, drives, and items using SharePoint URLs instead of item or drive ID values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/elipousson/sharepointr" class="external-link">sharepointr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="reading-and-writing-objects-to-and-from-sharepoint">Reading and writing objects to and from SharePoint<a class="anchor" aria-label="anchor" href="#reading-and-writing-objects-to-and-from-sharepoint"></a>
</h3>
<p>The most useful functions for most users may be <code><a href="reference/read_sharepoint.html">read_sharepoint()</a></code> and <code><a href="reference/write_sharepoint.html">write_sharepoint()</a></code>.</p>
<p><code><a href="reference/read_sharepoint.html">read_sharepoint()</a></code> downloads a SharePoint file to a temporary folder and then, based on the file extension, reads it into your environment using an appropriate function and package (e.g. using <code><a href="https://davidgohel.github.io/officer/reference/read_docx.html" class="external-link">officer::read_docx()</a></code> for Microsoft Word files or <code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">sf::read_sf()</a></code> for common spatial data files):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">docx_shared_url</span> <span class="op">&lt;-</span> <span class="st">"https://bmore.sharepoint.com/:w:/r/sites/MayorsOffice-DataGovernance/Shared%20Documents/General/Baltimore%20Data%20Academy/Baltimore%20Data%20Academy%20Announcement%20Content.docx?d=w0a50d3cd74ce4a8da6d82596037f0148&amp;csf=1&amp;web=1&amp;e=cBURo2"</span></span>
<span></span>
<span><span class="fu"><a href="reference/read_sharepoint.html">read_sharepoint</a></span><span class="op">(</span><span class="va">docx_shared_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Getting item from SharePoint</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt; ✔ Getting item from SharePoint [1.4s]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Downloading SharePoint item to '/var/folders/3f/50m42dx1333_dfqb5772j6_40000g…</span></span>
<span><span class="co">#&gt; ✔ Downloading SharePoint item to '/var/folders/3f/50m42dx1333_dfqb5772j6_40000g…</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Reading item with `officer::read_docx()`</span></span>
<span><span class="co">#&gt; ✔ Reading item with `officer::read_docx()` [31ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; rdocx document with 19 element(s)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * styles:</span></span>
<span><span class="co">#&gt;                 Normal Default Paragraph Font           Normal Table </span></span>
<span><span class="co">#&gt;            "paragraph"            "character"                "table" </span></span>
<span><span class="co">#&gt;                No List         List Paragraph   annotation reference </span></span>
<span><span class="co">#&gt;            "numbering"            "paragraph"            "character" </span></span>
<span><span class="co">#&gt;        annotation text      Comment Text Char     annotation subject </span></span>
<span><span class="co">#&gt;            "paragraph"            "character"            "paragraph" </span></span>
<span><span class="co">#&gt;   Comment Subject Char              Hyperlink     Unresolved Mention </span></span>
<span><span class="co">#&gt;            "character"            "character"            "character" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; * Content at cursor location:</span></span>
<span><span class="co">#&gt;   level num_id</span></span>
<span><span class="co">#&gt; 1    NA     NA</span></span>
<span><span class="co">#&gt;                                                                                                                                                  text</span></span>
<span><span class="co">#&gt; 1 If you have questions or feedback about the program, contact Chief Data Officer Justin Elszasz at justin.elszasz@baltimorecity.gov. Happy learning!</span></span>
<span><span class="co">#&gt;   style_name content_type</span></span>
<span><span class="co">#&gt; 1         NA    paragraph</span></span></code></pre></div>
<p><code><a href="reference/write_sharepoint.html">write_sharepoint()</a></code> saves an R object to local files and then uses <code><a href="reference/upload_sp_item.html">upload_sp_item()</a></code> to uploads the file to SharePoint.</p>
<p>I plan on adding features to allow the custom mapping of file extensions and object classes to specific functions or packages and adding more thorough documentation. Feel free to submit an issue or make a pull request if you have ideas of how to do this.</p>
</div>
<div class="section level3">
<h3 id="working-with-sharepoint-items-lists-and-plans">Working with SharePoint items, lists, and plans<a class="anchor" aria-label="anchor" href="#working-with-sharepoint-items-lists-and-plans"></a>
</h3>
<p>This package currently support three main categories of SharePoint objects:</p>
<ul>
<li>
<p><strong>Items and item properties</strong> including:</p>
<ul>
<li><p><strong>Directories</strong></p></li>
<li><p><strong>Files</strong></p></li>
</ul>
</li>
<li><p><strong>Lists and list items</strong></p></li>
<li><p><strong>Plans and tasks</strong></p></li>
</ul>
<p>Typically these functions return a <code>ms_object</code> object, a list of <code>ms_object</code> objects, or a data frame. In some cases, the data frame is based on the object properties and includes a list column where the <code>ms_object</code> is stored.</p>
<p>For example, <code><a href="reference/get_sp_item.html">get_sp_item()</a></code> returns a <code>ms_drive_item</code> object and supports parsing for shared file and folder URLs:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_sp_item.html">get_sp_item</a></span><span class="op">(</span><span class="va">docx_shared_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt; &lt;Drive item 'Baltimore Data Academy Announcement Content.docx'&gt;</span></span>
<span><span class="co">#&gt;   directory id: 017P4HV6ON2NIAVTTURVFKNWBFSYBX6AKI </span></span>
<span><span class="co">#&gt;   web link: https://bmore.sharepoint.com/sites/MayorsOffice-DataGovernance/_layouts/15/Doc.aspx?sourcedoc=%7B0A50D3CD-74CE-4A8D-A6D8-2596037F0148%7D&amp;file=Baltimore%20Data%20Academy%20Announcement%20Content.docx&amp;action=default&amp;mobileredirect=true </span></span>
<span><span class="co">#&gt;   type: file </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt;   Methods:</span></span>
<span><span class="co">#&gt;     copy, create_folder, create_share_link, delete,</span></span>
<span><span class="co">#&gt;     do_operation, download, get_item, get_list_pager,</span></span>
<span><span class="co">#&gt;     get_parent_folder, get_path, is_folder, list_files,</span></span>
<span><span class="co">#&gt;     list_items, load_dataframe, load_rdata, load_rds, move,</span></span>
<span><span class="co">#&gt;     open, save_dataframe, save_rdata, save_rds, sync_fields,</span></span>
<span><span class="co">#&gt;     update, upload</span></span></code></pre></div>
<p>Set <code>as_data_frame = TRUE</code> to return a data frame instead of a <code>ms_drive_item</code> object:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_sp_item.html">get_sp_item</a></span><span class="op">(</span><span class="va">docx_shared_url</span>, as_data_frame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt;                                                                                                                           @odata.context</span></span>
<span><span class="co">#&gt; 1 https://graph.microsoft.com/beta/$metadata#drives('b%21txygHcd2h0SzmOxg3_j1LZpAvnrrKrhOjcOP6RBpB6-8Kta613N3QJlbvrVKyTwO')/root/$entity</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       @microsoft.graph.downloadUrl</span></span>
<span><span class="co">#&gt; 1 https://bmore.sharepoint.com/sites/MayorsOffice-DataGovernance/_layouts/15/download.aspx?UniqueId=0a50d3cd-74ce-4a8d-a6d8-2596037f0148&amp;Translate=false&amp;tempauth=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDAvYm1vcmUuc2hhcmVwb2ludC5jb21AMzEyY2IxMjYtYzZhZS00ZmMyLTgwMGQtMzE4ZTY3OWNlNmM3IiwiaXNzIjoiMDAwMDAwMDMtMDAwMC0wZmYxLWNlMDAtMDAwMDAwMDAwMDAwIiwibmJmIjoiMTY5NzI0OTkzMiIsImV4cCI6IjE2OTcyNTM1MzIiLCJlbmRwb2ludHVybCI6ImVWS1o5aHllbHVsNU9PdzR6OWQ1U01sOVBkZXpXTjNOU3NscWxGM3V2ME09IiwiZW5kcG9pbnR1cmxMZW5ndGgiOiIxNTAiLCJpc2xvb3BiYWNrIjoiVHJ1ZSIsImNpZCI6IklqOFZaK0tNMjBhMTdRWm1mbmtEaFE9PSIsInZlciI6Imhhc2hlZHByb29mdG9rZW4iLCJzaXRlaWQiOiJNV1JoTURGallqY3ROelpqTnkwME5EZzNMV0l6T1RndFpXTTJNR1JtWmpobU5USmsiLCJhcHBfZGlzcGxheW5hbWUiOiJBenVyZVIvTWljcm9zb2Z0MzY1UiIsImdpdmVuX25hbWUiOiJFbGkiLCJmYW1pbHlfbmFtZSI6IlBvdXNzb24iLCJhcHBpZCI6ImQ0NGEwNWQ1LWM2YTUtNGJiYi04MmQyLTQ0MzEyMzcyMjM4MCIsInRpZCI6IjMxMmNiMTI2LWM2YWUtNGZjMi04MDBkLTMxOGU2NzljZTZjNyIsInVwbiI6ImVsaS5wb3Vzc29uQGJhbHRpbW9yZWNpdHkuZ292IiwicHVpZCI6IjEwMDMyMDAxRkQ3Q0UxMjQiLCJjYWNoZWtleSI6IjBoLmZ8bWVtYmVyc2hpcHwxMDAzMjAwMWZkN2NlMTI0QGxpdmUuY29tIiwic2NwIjoiZ3JvdXAud3JpdGUgYWxsc2l0ZXMubWFuYWdlIGFsbHNpdGVzLndyaXRlIiwidHQiOiIyIiwiaXBhZGRyIjoiNDAuMTI2LjIzLjE2MyJ9._IiwMB1EySiQXt2kSImD4jeSxuVFirvA2skJQYIa8uw&amp;ApiVersion=2.0</span></span>
<span><span class="co">#&gt;        createdDateTime                                        eTag</span></span>
<span><span class="co">#&gt; 1 2023-01-13T16:42:07Z "{0A50D3CD-74CE-4A8D-A6D8-2596037F0148},56"</span></span>
<span><span class="co">#&gt;                                   id lastModifiedDateTime</span></span>
<span><span class="co">#&gt; 1 017P4HV6ON2NIAVTTURVFKNWBFSYBX6AKI 2023-01-26T18:17:57Z</span></span>
<span><span class="co">#&gt;                                               name</span></span>
<span><span class="co">#&gt; 1 Baltimore Data Academy Announcement Content.docx</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                      webUrl</span></span>
<span><span class="co">#&gt; 1 https://bmore.sharepoint.com/sites/MayorsOffice-DataGovernance/_layouts/15/Doc.aspx?sourcedoc=%7B0A50D3CD-74CE-4A8D-A6D8-2596037F0148%7D&amp;file=Baltimore%20Data%20Academy%20Announcement%20Content.docx&amp;action=default&amp;mobileredirect=true</span></span>
<span><span class="co">#&gt;                                             cTag  size</span></span>
<span><span class="co">#&gt; 1 "c:{0A50D3CD-74CE-4A8D-A6D8-2596037F0148},140" 76665</span></span>
<span><span class="co">#&gt;                                                                                 createdBy</span></span>
<span><span class="co">#&gt; 1 Justin.Elszasz@baltimorecity.gov, a43c19f9-9a13-403d-9234-0c13f4e84b1c, Elszasz, Justin</span></span>
<span><span class="co">#&gt;                                                                                       lastModifiedBy</span></span>
<span><span class="co">#&gt; 1 Michael.Gottlieb@baltimorecity.gov, a2dedf36-3fce-4998-92f5-9350e749769f, Gottlieb, Michael (BCIT)</span></span>
<span><span class="co">#&gt;   shared</span></span>
<span><span class="co">#&gt; 1  users</span></span>
<span><span class="co">#&gt;                                                                                                                                                                                                                                                                                          parentReference</span></span>
<span><span class="co">#&gt; 1 documentLibrary, b!txygHcd2h0SzmOxg3_j1LZpAvnrrKrhOjcOP6RBpB6-8Kta613N3QJlbvrVKyTwO, 017P4HV6NGOMGBBVI5GBBZU5BFDTPDKJ7W, Baltimore Data Academy, /drives/b!txygHcd2h0SzmOxg3_j1LZpAvnrrKrhOjcOP6RBpB6-8Kta613N3QJlbvrVKyTwO/root:/General/Baltimore Data Academy, 1da01cb7-76c7-4487-b398-ec60dff8f52d</span></span>
<span><span class="co">#&gt;                                                                                                    file</span></span>
<span><span class="co">#&gt; 1 application/vnd.openxmlformats-officedocument.wordprocessingml.document, CftrnHpBa4HAhtv+a3TALjSSvS0=</span></span>
<span><span class="co">#&gt;                               fileSystemInfo                    ms_item</span></span>
<span><span class="co">#&gt; 1 2023-01-13T16:42:07Z, 2023-01-26T18:17:57Z &lt;environment: 0x112094a58&gt;</span></span></code></pre></div>
<p>These basic functions to “get” objects are extended by functions like <code><a href="reference/download_sp_item.html">download_sp_item()</a></code> that adds support for downloading copies of your SharePoint files (this is the function that powers <code><a href="reference/read_sharepoint.html">read_sharepoint()</a></code>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_tempfile.html" class="external-link">with_tempdir</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">docx_dest</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/download_sp_item.html">download_sp_item</a></span><span class="op">(</span><span class="va">docx_shared_url</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">docx_dest</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Getting item from SharePoint</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt; ✔ Getting item from SharePoint [644ms]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Downloading SharePoint item to 'Baltimore Data Academy Announcement Content.d…</span></span>
<span><span class="co">#&gt; ✔ Downloading SharePoint item to 'Baltimore Data Academy Announcement Content.d…</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Some of the original <a href="https://github.com/Azure/Microsoft365R" class="external-link">Microsoft365R</a> S6 object methods already return a data frame by default such as <code><a href="reference/sp_dir_info.html">sp_dir_info()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/sp_dir_info.html">sp_dir_info</a></span><span class="op">(</span><span class="st">"https://bmore.sharepoint.com/:w:/r/sites/MayorsOffice-DataGovernance/Shared%20Documents/General/Baltimore%20Data%20Academy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt;                                                                                                                                name</span></span>
<span><span class="co">#&gt; 1                                                                                              General/Baltimore Data Academy/Logos</span></span>
<span><span class="co">#&gt; 2                                                 General/Baltimore Data Academy/BALT 02 Interpreting Data - Student Coursebook.pdf</span></span>
<span><span class="co">#&gt; 3                                            General/Baltimore Data Academy/BALT 03_Leading with Data_Workday Lesson 1_03292023.pdf</span></span>
<span><span class="co">#&gt; 4                                             General/Baltimore Data Academy/BALT 04_Data Stewardship_Workday Lesson 1_03292023.pdf</span></span>
<span><span class="co">#&gt; 5  General/Baltimore Data Academy/BALT 05_Measuring Government Performance_Course Access Instructions_Workday Lesson 1_02282023.pdf</span></span>
<span><span class="co">#&gt; 6                                                   General/Baltimore Data Academy/Baltimore Data Academy Announcement Content.docx</span></span>
<span><span class="co">#&gt; 7                                        General/Baltimore Data Academy/Baltimore Data Academy New Course Announcement 7.11.23.docx</span></span>
<span><span class="co">#&gt; 8                                                                           General/Baltimore Data Academy/Curriculum One Pager.pdf</span></span>
<span><span class="co">#&gt; 9                                                                                      General/Baltimore Data Academy/Document.docx</span></span>
<span><span class="co">#&gt; 10                                                        General/Baltimore Data Academy/Foundations of Data Literacy_2023 [43].pdf</span></span>
<span><span class="co">#&gt; 11                                       General/Baltimore Data Academy/Interpreting Data with Greater Accuracy and Insight[97].pdf</span></span>
<span><span class="co">#&gt; 12                                                              General/Baltimore Data Academy/Last SR by Agency as of 7.11.23.xlsx</span></span>
<span><span class="co">#&gt;       size isdir                                 id      type</span></span>
<span><span class="co">#&gt; 1    3.26M  TRUE 017P4HV6I3IGKTFCO2FZD3FXPCGUPJSO6G directory</span></span>
<span><span class="co">#&gt; 2  703.38K FALSE 017P4HV6KITC7MJJJESFD35BIDU5DR4BSL      file</span></span>
<span><span class="co">#&gt; 3  388.91K FALSE 017P4HV6N2LBZHX6ERCBCIQRJIXGTZMYCK      file</span></span>
<span><span class="co">#&gt; 4  389.67K FALSE 017P4HV6ICFKFITU4WC5CYAFJUTZAMHP7K      file</span></span>
<span><span class="co">#&gt; 5  391.34K FALSE 017P4HV6MQCBPQQD6VUVCJWMWAKTIBZNYQ      file</span></span>
<span><span class="co">#&gt; 6   74.87K FALSE 017P4HV6ON2NIAVTTURVFKNWBFSYBX6AKI      file</span></span>
<span><span class="co">#&gt; 7   53.95K FALSE 017P4HV6PKOSFTLSMOAJDK3OGKFUVCIICU      file</span></span>
<span><span class="co">#&gt; 8   88.45K FALSE 017P4HV6OKNLH7UWTQJBEZXWNFXBGBC6OC      file</span></span>
<span><span class="co">#&gt; 9   48.51K FALSE 017P4HV6L5XTQ7IOMVYBGKSYMSOYDXMMPZ      file</span></span>
<span><span class="co">#&gt; 10 536.85K FALSE 017P4HV6KALORFIRC2IBB3RN52WE4V7QGU      file</span></span>
<span><span class="co">#&gt; 11  618.2K FALSE 017P4HV6NWPAN6PTWC3FEJB3KRR2WDWXFM      file</span></span>
<span><span class="co">#&gt; 12  15.74K FALSE 017P4HV6K2WP2LBTN6PFGLVY4PIWOY7IAR      file</span></span></code></pre></div>
<p>Others use the <code>as_data_frame</code> parameter to convert a list into a data frame as a convenient alternative.</p>
</div>
<div class="section level3">
<h3 id="helpers-for-sharepoint-sites-and-drives">Helpers for SharePoint sites and drives<a class="anchor" aria-label="anchor" href="#helpers-for-sharepoint-sites-and-drives"></a>
</h3>
<p>Most functions in the package rely on a pair of helper functions: <code><a href="reference/sp_site.html">get_sp_site()</a></code>, <code><a href="reference/sp_drive.html">get_sp_drive()</a></code>, and <code><a href="reference/get_sp_item.html">get_sp_item()</a></code>, that can parse a URL to determine the SharePoint site URL, drive name, and file path based on the URL.</p>
<p><code><a href="reference/sp_site.html">get_sp_site()</a></code> is a minimal wrapper for <code><a href="https://rdrr.io/pkg/Microsoft365R/man/client.html" class="external-link">Microsoft365R::get_sharepoint_site()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">site_url</span> <span class="op">&lt;-</span> <span class="st">"https://bmore.sharepoint.com/sites/MayorsOffice-DataGovernance"</span></span>
<span></span>
<span><span class="fu"><a href="reference/sp_site.html">get_sp_site</a></span><span class="op">(</span>site_url <span class="op">=</span> <span class="va">site_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt; &lt;Sharepoint site 'Citywide Data Network'&gt;</span></span>
<span><span class="co">#&gt;   directory id: bmore.sharepoint.com,1da01cb7-76c7-4487-b398-ec60dff8f52d,7abe409a-2aeb-4eb8-8dc3-8fe9106907af </span></span>
<span><span class="co">#&gt;   web link: https://bmore.sharepoint.com/sites/MayorsOffice-DataGovernance </span></span>
<span><span class="co">#&gt;   description: If you work with or are interested in data, feel free to join! </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt;   Methods:</span></span>
<span><span class="co">#&gt;     delete, do_operation, get_drive, get_group, get_list,</span></span>
<span><span class="co">#&gt;     get_list_pager, get_lists, list_drives, list_subsites,</span></span>
<span><span class="co">#&gt;     sync_fields, update</span></span></code></pre></div>
<p><code><a href="reference/sp_drive.html">get_sp_drive()</a></code> returns a <code>ms_drive</code> object but required a SharePoint URL that includes the name of the drive (otherwise it returns the drive named in the “sharepointr.default_drive_name” option):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/sp_drive.html">get_sp_drive</a></span><span class="op">(</span><span class="va">docx_shared_url</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading Microsoft Graph login for default tenant</span></span>
<span><span class="co">#&gt; &lt;Document library 'Documents'&gt;</span></span>
<span><span class="co">#&gt;   directory id: b!txygHcd2h0SzmOxg3_j1LZpAvnrrKrhOjcOP6RBpB6-8Kta613N3QJlbvrVKyTwO </span></span>
<span><span class="co">#&gt;   web link: https://bmore.sharepoint.com/sites/MayorsOffice-DataGovernance/Shared%20Documents </span></span>
<span><span class="co">#&gt;   description:  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt;   Methods:</span></span>
<span><span class="co">#&gt;     copy_item, create_folder, create_share_link, delete,</span></span>
<span><span class="co">#&gt;     delete_item, do_operation, download_file, download_folder,</span></span>
<span><span class="co">#&gt;     get_item, get_item_properties, get_list_pager, list_files,</span></span>
<span><span class="co">#&gt;     list_items, list_shared_files, list_shared_items,</span></span>
<span><span class="co">#&gt;     load_dataframe, load_rdata, load_rds, move_item, open_item,</span></span>
<span><span class="co">#&gt;     save_dataframe, save_rdata, save_rds, set_item_properties,</span></span>
<span><span class="co">#&gt;     sync_fields, update, upload_file, upload_folder</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="related-packages">Related packages<a class="anchor" aria-label="anchor" href="#related-packages"></a>
</h2>
<p>There are two similar packages available:</p>
<ul>
<li>
<a href="https://gitlab.com/tolmay/sharrpoint" class="external-link">sharrpoint</a>: An R package to interact with Sharepoint API (files &amp; lists).</li>
<li>
<a href="https://github.com/LukasK13/sharepointr" class="external-link">sharepointr</a>: A R package for reading from and writing to SharePoint lists.</li>
</ul>
<p>I may rename this package to avoid the name conflict with the existing sharepointr package—I didn’t find it until after I set up the repository. However, it has a more limited feature set and may be no longer under development so I may stick with the current name.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/elipousson/sharepointr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/elipousson/sharepointr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sharepointr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Eli Pousson <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-8280-1706" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Eli Pousson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
