<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read a SharePoint item based on a file URL or file name and site details — read_sharepoint • sharepointr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read a SharePoint item based on a file URL or file name and site details — read_sharepoint"><meta name="description" content='read_sharepoint() is designed to download a SharePoint item to a temporary
folder and read the file based on the file extension. If a function is
provided to .f, it is used to read the downloaded file. If not, class of the
returned object depends on the file extension of the file parameter.
If the file is a csv, csv2, or tsv file or a Microsoft Excel file (xlsx or
xls), readr::read_delim() or readxl::read_excel() is used to return a
data frame.
If the file is a rds file, readr::read_rds() is used to return the saved
object.
If the file is a pptx or docx file, officer::read_docx() or
officer::read_pptx() are used to read the file into a rdocx or rpptx
object.
If the file has a "gpkg", "geojson", "kml", "gdb", or "zip" file extension,
sf::read_sf() is used to read the file into a sf data frame.


If the file has none of these file extensions, an attempt is made to read the
file with readr::read_lines().
The function also serves as a wrapper for list_sp_list_items() if the
provided file parameter is a SharePoint list URL.'><meta property="og:description" content='read_sharepoint() is designed to download a SharePoint item to a temporary
folder and read the file based on the file extension. If a function is
provided to .f, it is used to read the downloaded file. If not, class of the
returned object depends on the file extension of the file parameter.
If the file is a csv, csv2, or tsv file or a Microsoft Excel file (xlsx or
xls), readr::read_delim() or readxl::read_excel() is used to return a
data frame.
If the file is a rds file, readr::read_rds() is used to return the saved
object.
If the file is a pptx or docx file, officer::read_docx() or
officer::read_pptx() are used to read the file into a rdocx or rpptx
object.
If the file has a "gpkg", "geojson", "kml", "gdb", or "zip" file extension,
sf::read_sf() is used to read the file into a sf data frame.


If the file has none of these file extensions, an attempt is made to read the
file with readr::read_lines().
The function also serves as a wrapper for list_sp_list_items() if the
provided file parameter is a SharePoint list URL.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sharepointr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/read-write.html">Reading and writing items from SharePoint</a></li>
    <li><a class="dropdown-item" href="../articles/sp_url.html">Using SharePoint URLs to work with items and lists</a></li>
    <li><a class="dropdown-item" href="../articles/sp-lists.html">Reading and writing to SharePoint Lists</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/elipousson/sharepointr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read a SharePoint item based on a file URL or file name and site details</h1>
      <small class="dont-index">Source: <a href="https://github.com/elipousson/sharepointr/blob/main/R/read_sharepoint.R" class="external-link"><code>R/read_sharepoint.R</code></a></small>
      <div class="d-none name"><code>read_sharepoint.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>read_sharepoint()</code> is designed to download a SharePoint item to a temporary
folder and read the file based on the file extension. If a function is
provided to .f, it is used to read the downloaded file. If not, class of the
returned object depends on the file extension of the file parameter.</p><ul><li><p>If the file is a csv, csv2, or tsv file or a Microsoft Excel file (xlsx or
xls), <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_delim()</a></code> or <code><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">readxl::read_excel()</a></code> is used to return a
data frame.</p></li>
<li><p>If the file is a rds file, <code><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">readr::read_rds()</a></code> is used to return the saved
object.</p></li>
<li><p>If the file is a pptx or docx file, <code><a href="https://davidgohel.github.io/officer/reference/read_docx.html" class="external-link">officer::read_docx()</a></code> or
<code><a href="https://davidgohel.github.io/officer/reference/read_pptx.html" class="external-link">officer::read_pptx()</a></code> are used to read the file into a <code>rdocx</code> or <code>rpptx</code>
object.</p></li>
<li><p>If the file has a "gpkg", "geojson", "kml", "gdb", or "zip" file extension,
<code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">sf::read_sf()</a></code> is used to read the file into a <code>sf</code> data frame.</p></li>
</ul><p>If the file has none of these file extensions, an attempt is made to read the
file with <code><a href="https://readr.tidyverse.org/reference/read_lines.html" class="external-link">readr::read_lines()</a></code>.</p>
<p>The function also serves as a wrapper for <code><a href="sp_list_item.html">list_sp_list_items()</a></code> if the
provided <code>file</code> parameter is a SharePoint list URL.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_sharepoint</span><span class="op">(</span></span>
<span>  <span class="va">file</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  .f <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  new_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drive_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drive_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  drive <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_url <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>Required. A SharePoint shared file URL, document URL, or, if
<code>item_id</code> is supplied, a file name to use in combination with <code>new_path</code> to
set <code>dest</code> with location and filename for downloaded item. If file appears
to be a SharePoint list URL, the list items are retrived with
<code><a href="sp_list_item.html">list_sp_list_items()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters passed to one of the functions identified in
the description or supplied to <code>.f</code></p></dd>


<dt id="arg--f">.f<a class="anchor" aria-label="anchor" href="#arg--f"></a></dt>
<dd><p>Optional function to use to read file downloaded from SharePoint.</p></dd>


<dt id="arg-new-path">new_path<a class="anchor" aria-label="anchor" href="#arg-new-path"></a></dt>
<dd><p>Path to directory for downloaded item. Optional if <code>dest</code> is
supplied. If path contains a file name, the item will be downloaded using
that file name instead of the file name of the original item. If <code>new_path</code>
refers to a nonexistent directory and the item is a file, the directory
will be silently created using <code><a href="https://fs.r-lib.org/reference/create.html" class="external-link">fs::dir_create()</a></code>.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>If <code>TRUE</code>, replace the existing cached object named by
<code>cache_file</code> with the new object. If <code>FALSE</code>, error if a cached file with
the same <code>cache_file</code> name already exists.</p></dd>


<dt id="arg-drive-name-drive-id">drive_name, drive_id<a class="anchor" aria-label="anchor" href="#arg-drive-name-drive-id"></a></dt>
<dd><p>SharePoint drive name or ID.</p></dd>


<dt id="arg-drive">drive<a class="anchor" aria-label="anchor" href="#arg-drive"></a></dt>
<dd><p>A <code>ms_drive</code> object. If drive is supplied, <code>drive_name</code>,
<code>site_url</code>, and any additional parameters passed to <code>...</code> are ignored.</p></dd>


<dt id="arg-site-url">site_url<a class="anchor" aria-label="anchor" href="#arg-site-url"></a></dt>
<dd><p>A SharePoint site URL in the format "https://[tenant
name].sharepoint.com/sites/[site name]". Any SharePoint item or document
URL can also be parsed to build a site URL using the tenant and site name
included in the URL.</p></dd>


<dt id="arg-site-name-site-id">site_name, site_id<a class="anchor" aria-label="anchor" href="#arg-site-name-site-id"></a></dt>
<dd><p>Site name or ID of the SharePoint site as an
alternative to the SharePoint site URL. Exactly one of  <code>site_url</code>,
<code>site_name</code>, and <code>site_id</code> must be supplied.</p></dd>


<dt id="arg-site">site<a class="anchor" aria-label="anchor" href="#arg-site"></a></dt>
<dd><p>A <code>ms_site</code> object. If <code>site</code> is supplied, <code>site_url</code>,
<code>site_name</code>, and <code>site_id</code> are ignored.</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eli Pousson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

